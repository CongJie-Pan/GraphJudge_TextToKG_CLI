# Unified CLI Pipeline Architecture - Base Configuration Template
# 統一CLI管道架構 - 基本配置模板
#
# This is the base configuration template for the knowledge graph generation pipeline.
# Iteration-specific configurations will be auto-generated based on this template.
#
# Author: Engineering Team
# Date: 2025-01-15
# Version: 1.0.0

# Pipeline-level configuration
pipeline:
  # Iteration number - use 'auto-prompt' to prompt user interactively
  iteration: auto-prompt
  
  # Number of parallel workers for concurrent processing
  parallel_workers: 5
  
  # Frequency of checkpoint saves (every N processed items)
  checkpoint_frequency: 10
  
  # Error tolerance rate (0.0 = no errors allowed, 1.0 = all errors ignored)
  error_tolerance: 0.1
  
  # Automatically create directory structures
  auto_create_directories: true
  
  # Base output path for iterations
  base_output_path: "./docs/Iteration_Report"

# Stage-specific configurations
stages:
  # ECTD (Entity Extraction & Text Denoising) Stage
  ectd:
    # KIMI-K2 model configuration
    model: kimi-k2
    temperature: 0.3
    batch_size: 20
    cache_enabled: true
    
    # Output settings
    entity_output_format: txt
    denoised_output_format: target
    
    # Processing options
    enable_deduplication: true
    enable_type_annotation: true
    
  # Triple Generation Stage  
  triple_generation:
    # Output format for generated triples
    output_format: json
    
    # Enable schema validation using Pydantic
    validation_enabled: true
    
    # Path to relation mapping file for vocabulary standardization
    relation_mapping: ./config/relation_map.json
    
    # Text chunking settings for large inputs
    enable_pagination: true
    max_tokens_per_chunk: 1000
    chunk_overlap: 100
    
    # Post-processing options
    enable_post_processing: true
    enable_deduplication: true
    
  # Graph Judge Stage
  graph_judge:
    # Enable explainable mode with detailed reasoning
    explainable_mode: true
    
    # Confidence threshold for judgment decisions (0.0-1.0)
    confidence_threshold: 0.7
    
    # Evidence sources for grounding judgments
    evidence_sources:
      - source_text
      - domain_knowledge
    
    # Dual-file output strategy
    csv_output_enabled: true      # Standard CSV for compatibility
    reasoning_output_enabled: true  # JSON file with detailed reasoning
    
    # Gold label bootstrapping settings
    enable_bootstrapping: false
    fuzzy_threshold: 0.8
    sample_rate: 0.15
    
  # Evaluation Stage
  evaluation:
    # Metrics to compute during evaluation
    metrics:
      - triple_match_f1
      - graph_match_accuracy  
      - g_bleu
      - g_rouge
      - g_bert_score
    
    # Path to gold standard file for evaluation
    gold_standard: ./datasets/gold_standard.json
    
    # Output formats
    json_graph_enabled: true
    evaluation_report_enabled: true
    
    # Conversion settings
    enable_graph_conversion: true
    graph_format: json

# Monitoring and logging configuration
monitoring:
  # Enable real-time performance monitoring
  enabled: true
  
  # Monitoring interval in seconds
  interval: 5.0
  
  # Maximum performance samples to keep in memory
  max_samples: 1000
  
  # Log levels: DEBUG, INFO, WARNING, ERROR
  log_level: INFO
  
  # Enable resource usage tracking
  track_system_resources: true
  
# Error handling and recovery
error_handling:
  # Maximum retry attempts for failed operations
  max_retries: 3
  
  # Base delay between retries (seconds)
  base_retry_delay: 1.0
  
  # Enable exponential backoff for retries
  exponential_backoff: true
  
  # Continue pipeline execution on non-critical errors
  continue_on_error: true
  
  # Save error details for debugging
  save_error_details: true

# API rate limiting configuration  
rate_limiting:
  # KIMI API settings
  kimi:
    rpm_limit: 60
    concurrent_limit: 3
    base_delay: 1.0
    
  # Gemini API settings  
  gemini:
    rpm_limit: 120
    concurrent_limit: 2
    base_delay: 0.5

# Quality assurance settings
quality_assurance:
  # Enable automatic quality checks
  enabled: true
  
  # Minimum success rate for stages (0.0-1.0)
  min_success_rate: 0.7
  
  # Enable data validation between stages
  validate_stage_outputs: true
  
  # Generate quality reports
  generate_qa_reports: true

# Advanced features
advanced:
  # Enable experimental features
  experimental_features: false
  
  # Enable performance profiling
  performance_profiling: false
  
  # Custom hooks for stage execution
  enable_custom_hooks: false
  
  # Integration with external systems
  external_integrations: false
