# 知識圖譜可視化器 - 使用指南 🏮

## 📋 概述

本系統現已升級支援**動態檔案選擇功能**，使用者可以直接在網站上上傳、管理和選擇不同的知識圖譜檔案，無需修改任何程式碼。

## 🚀 快速開始

### 1. 啟動服務器
```bash
cd Miscellaneous/KgGen/kgGenShows
npm install  # 首次使用需要安裝依賴
npm start
```

### 2. 開啟瀏覽器
訪問 `http://localhost:3000` 即可開始使用。

## 🌟 新功能介紹

### 📁 檔案管理功能

#### 檔案上傳
- **拖放上傳**：將 JSON 檔案直接拖放到上傳區域
- **點擊上傳**：點擊「選擇檔案」按鈕選擇檔案
- **格式驗證**：自動檢查檔案格式和結構
- **自動命名**：上傳檔案會自動加上時間戳避免重名

#### 檔案管理
- **檔案列表**：顯示所有可用的圖譜檔案
- **檔案資訊**：顯示實體數量、關係數量、檔案大小、修改時間
- **檔案狀態**：顯示檔案是否有效（✅ 有效 / ❌ 無效）
- **檔案刪除**：可刪除不需要的檔案（原始檔案受保護）

#### 檔案選擇
- **一鍵選擇**：點擊檔案項目即可選中
- **即時載入**：選中檔案後立即載入新的圖譜數據
- **狀態指示**：選中的檔案會以不同顏色高亮顯示

### 🔍 可視化功能

#### 簡易版本
- 輕量化設計，快速載入
- 基本的拖拽和縮放功能
- 適合快速預覽圖譜結構

#### 完整版本
- 功能豐富的可視化器
- 搜尋和篩選功能
- 詳細的懸停提示
- 智能實體分類著色

## 📋 檔案格式要求

### JSON 結構
上傳的 JSON 檔案必須包含以下結構：

```json
{
  "entities": [
    "實體1",
    "實體2",
    "實體3"
  ],
  "relationships": [
    "實體1 - 關係描述 - 實體2",
    "實體2 - 關係描述 - 實體3"
  ]
}
```

### 檔案要求
- **格式**：必須是 `.json` 檔案
- **大小**：限制 50MB
- **編碼**：UTF-8 編碼
- **結構**：必須包含 `entities` 和 `relationships` 陣列

## 🛠️ 使用步驟

### 步驟 1：上傳新圖譜檔案
1. 點擊主頁面的「📁 檔案管理」標籤
2. 將 JSON 檔案拖放到上傳區域，或點擊「選擇檔案」
3. 等待上傳完成並顯示「✅ 檔案上傳成功」

### 步驟 2：選擇要可視化的圖譜
1. 在檔案列表中點擊想要使用的圖譜檔案
2. 檔案會被高亮顯示並自動載入
3. 返回「📊 檢視圖譜」標籤查看更新的統計資訊

### 步驟 3：開啟可視化器
1. 選擇「🔍 簡易版本」或「⚡ 完整版本」
2. 可視化器會自動載入所選檔案的圖譜數據
3. 開始探索您的知識圖譜！

## 🔧 進階功能

### URL 參數支援
可以透過 URL 參數直接指定要載入的檔案：
```
http://localhost:3000/simple?file=your_file.json
http://localhost:3000/full?file=your_file.json
```

### 自動錯誤修復
系統會自動檢測並修復常見的數據不一致問題：
- 關係中提到但實體列表中缺失的實體
- 會自動添加缺失的實體並在控制台報告修復詳情

### 檔案安全
- 原始範例檔案受到保護，無法被刪除
- 所有上傳檔案會進行格式驗證
- 無效檔案會被自動拒絕並刪除

## 🎨 界面說明

### 主頁面標籤
- **📊 檢視圖譜**：顯示當前圖譜統計和啟動可視化器
- **📁 檔案管理**：上傳、管理和選擇圖譜檔案

### 檔案狀態指示
- **✅ 有效**：檔案格式正確，可以正常使用
- **❌ 無效**：檔案格式有問題，需要檢查修正
- **🔒 原始檔案**：系統預設檔案，無法刪除

### 可視化器控制
- **搜尋節點**：在完整版中搜尋特定實體
- **縮放控制**：調整視圖縮放等級
- **重置視圖**：重置到初始視圖狀態
- **暫停/繼續**：控制力導向圖的動畫

## 🐛 故障排除

### 常見問題

**Q: 上傳檔案失敗**
- 檢查檔案是否為 `.json` 格式
- 確認檔案大小不超過 50MB
- 檢查 JSON 格式是否正確

**Q: 檔案顯示為無效**
- 確認檔案包含 `entities` 和 `relationships` 陣列
- 檢查 JSON 語法是否正確
- 確認檔案編碼為 UTF-8

**Q: 可視化器載入失敗**
- 確認服務器正在運行
- 檢查控制台是否有錯誤訊息
- 重新整理頁面重試

### 錯誤訊息說明
- `❌ 連接失敗`：服務器未啟動或網路問題
- `❌ 上傳失敗`：檔案格式不正確或伺服器錯誤
- `❌ 載入檔案列表失敗`：無法讀取檔案目錄

## 📚 API 端點

### 檔案管理 API
- `GET /api/graph-files` - 獲取檔案列表
- `POST /api/upload-graph` - 上傳新檔案
- `DELETE /api/graph-files/:filename` - 刪除檔案

### 數據 API
- `GET /api/graph-data` - 獲取預設圖譜數據
- `GET /api/graph-data?file=filename` - 獲取指定檔案的圖譜數據

## 🔄 更新日誌

### v2.0.0 - 動態檔案支援
- ✅ 新增檔案上傳功能
- ✅ 新增檔案管理界面
- ✅ 支援動態檔案選擇
- ✅ 自動檔案格式驗證
- ✅ URL 參數支援
- ✅ 錯誤處理和用戶反饋改進

## 📞 技術支援

如果遇到任何問題，請：
1. 檢查控制台錯誤訊息
2. 確認檔案格式符合要求
3. 重啟服務器重試

---

🎉 現在您可以輕鬆地管理和可視化多個知識圖譜檔案，無需任何程式碼修改！ 